<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Glass Candles - Nook Decor</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Didot&display=swap" rel="stylesheet">

  <style>
    :root{
      --beige:#DFC9AB;
      --burgundy:#4b0e1f;
      --line:rgba(75,14,31,.18);
    }

    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: var(--beige);
      color: var(--burgundy);
      background-image: url('https://i.postimg.cc/SRyhwTQC/05fb948d-3338-4095-bbbf-f9b5fea98579.png');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }

    header {
      background-color: rgba(223,201,171,0.92);
      padding: 15px;
      text-align: center;
      font-family: 'Didot', serif;
      font-size: 32px;
      font-weight: bold;
      border-bottom: 1px solid var(--line);
      position: relative;
    }

    /* ✅ Language switch — SAME STYLE AS ADD TO CART */
    #langSelect {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      padding: 8px 14px;
      border: none;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      background-color: var(--burgundy);
      color: var(--beige);
      font-family: 'Poppins', sans-serif;
      transition: 0.25s ease;
    }

    #langSelect:hover {
      opacity: 0.9;
    }

    .product-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 30px;
      gap: 30px;
    }

    .product-card {
      background-color: var(--beige);
      border-radius: 15px;
      padding: 12px;
      max-width: 270px;
      text-align: center;
      box-shadow: 0 6px 18px rgba(75,14,31,0.25);
      transition: 0.3s;
    }

    .product-card img {
      width: 100%;
      height: 420px;
      object-fit: cover;
      border-radius: 15px;
      margin-bottom: 10px;
    }

    .product-card h1 {
      font-size: 20px;
      font-family: 'Didot', serif;
      margin-bottom: 8px;
      color: var(--burgundy);
    }

    .product-card p {
      line-height: 1.5;
      font-size: 14px;
      margin-bottom: 8px;
      opacity: 0;
      max-height: 0;
      overflow: hidden;
      transition: .35s;
      transform: translateY(15px);
    }

    .product-card:hover p {
      opacity: 1;
      max-height: 150px;
      transform: translateY(0);
    }

    .price {
      font-size: 18px;
      font-weight: bold;
      margin: 8px 0;
      color: var(--burgundy);
    }

    /* ✅ Add to Cart */
    .btn {
      background-color: var(--burgundy);
      border: none;
      color: var(--beige);
      padding: 8px 18px;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
      width: 100%;
      font-family: 'Poppins', sans-serif;
    }

    .btn:hover {
      opacity: 0.9;
    }

    .back-link {
      display: block;
      text-align: center;
      margin-top: 150px;
      margin-bottom: 40px;
      color: var(--burgundy);
      text-decoration: none;
      font-size: 20px;
      font-weight: 500;
    }

    @media (max-width: 768px) {
      .back-link {
        margin-top: 350px;
        font-size: 22px;
      }
    }
  </style>
</head>

<body>

<header>
  glass candles
  <select id="langSelect">
    <option value="en">English</option>
    <option value="ar">العربية</option>
  </select>
</header>

<div class="product-container" id="productContainer"></div>

<a href="index.html" class="back-link" id="backLink">← Back to Home</a>

<script>
const products = [
  {
    img:"https://i.postimg.cc/QNKS4RGP/cff5f436-c495-4bcf-9ce4-4dabd6e78ada.png",
    price:200,
    name:{en:"LED Glass Candle", ar:"شمعة زجاجية LED"},
    desc:{
      en:"Elegant LED glass candle that adds a cozy glow to any room.",
      ar:"شمعة LED زجاجية أنيقة تضيف توهجاً مريحاً لأي غرفة."
    }
  },
  {
    img:"https://i.postimg.cc/bwgRSPk6/c641973d-fa6b-404a-a7ba-a7fec43aaeea.png",
    price:130,
    name:{en:"Round LED Glass Candle", ar:"شمعة زجاجية دائرية LED"},
    desc:{
      en:"Beautiful round LED glass candle offering soft lighting.",
      ar:"شمعة زجاجية دائرية LED توفر إضاءة ناعمة."
    }
  }
];

/* ✅ UNIFIED CART KEY (same as Cart page) */
const CART_KEY = "nook_cart";

function safeParse(v){
  try { return JSON.parse(v); } catch(e){ return null; }
}
function getCart(){
  const data = safeParse(localStorage.getItem(CART_KEY));
  return Array.isArray(data) ? data : [];
}
function saveCart(cart){
  localStorage.setItem(CART_KEY, JSON.stringify(cart));
  localStorage.setItem("cartItems", JSON.stringify(cart)); // for checkout
}
function makeId(category, name, price, img){
  return `${category}__${name}__${price}__${img}`.toLowerCase()
    .replace(/\s+/g,"_")
    .replace(/[^\w\-]+/g,"");
}

function renderProducts(lang){
  const container=document.getElementById("productContainer");
  container.innerHTML="";

  products.forEach(p=>{
    const card=document.createElement("div");
    card.className="product-card";

    const productName = p.name[lang];
    const id = makeId("glass_candles", productName, p.price, p.img);

    card.dataset.id = id;
    card.dataset.name = productName;
    card.dataset.price = p.price;
    card.dataset.img = p.img;

    card.innerHTML=`
      <img src="${p.img}">
      <h1>${p.name[lang]}</h1>
      <p>${p.desc[lang]}</p>
      <div class="price">${p.price} EGP</div>
      <button class="btn add-to-cart">${lang==="ar"?"أضف إلى السلة":"Add to Cart"}</button>
    `;
    container.appendChild(card);
  });

  attachCart(lang);
}

function attachCart(lang){
  document.querySelectorAll(".add-to-cart").forEach(btn=>{
    btn.onclick=()=>{
      const card=btn.closest(".product-card");

      const product = {
        id: card.dataset.id,
        name: card.dataset.name,
        price: Number(card.dataset.price) || 0,
        img: card.dataset.img,
        qty: 1,
        category: "Glass Candles",
        page: location.pathname,
        addedAt: new Date().toISOString()
      };

      let cart=getCart();
      const existing=cart.find(p=>p.id===product.id);
      if(existing) existing.qty = (Number(existing.qty)||1) + 1;
      else cart.push(product);

      saveCart(cart);

      btn.textContent=lang==="ar"?"تم الإضافة!":"Added!";
      setTimeout(()=>{
        btn.textContent=lang==="ar"?"أضف إلى السلة":"Add to Cart";
      },1200);
    };
  });
}

/* Language switch */
const langSelect = document.getElementById("langSelect");
const backLink = document.getElementById("backLink");

langSelect.onchange=()=>{
  const lang=langSelect.value;
  document.body.dir=lang==="ar"?"rtl":"ltr";
  renderProducts(lang);
  backLink.textContent=lang==="ar"?"← العودة للرئيسية":"← Back to Home";
};

renderProducts("en");
</script>

</body>
</html>
