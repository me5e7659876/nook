<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Outdoor Flooring - Nook Decor</title>

<link href="https://fonts.googleapis.com/css2?family=Didot&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --beige:#DFC9AB;
    --burgundy:#4b0e1f;
    --line:rgba(75,14,31,.18);
  }

  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background-color: var(--beige);
    color: var(--burgundy);
  }

  header {
    background-color: var(--beige);
    padding: 20px 15px;
    text-align: center;
    font-size: 32px;
    font-weight: bold;
    position: relative;
    font-family: 'Didot', serif !important;
    border-bottom: 1px solid var(--line);
  }

  #langSelect {
    position: absolute;
    right: 15px;
    top: 62%;
    transform: translateY(-50%);
    padding: 3px 6px;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    background: var(--burgundy);
    color: var(--beige);
    font-size: 11px;
  }

  @media (max-width: 768px) {
    #langSelect {
      padding: 2px 5px;
      font-size: 10px;
      right: 10px;
      top: 65%;
    }
    header {
      font-size: 26px;
      padding: 18px;
    }
  }

  /* ====== CONTAINER ====== */
  .products {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 25px;
    padding: 30px;
  }

  /* ✅ شيلنا الكرت اللي ورا الصور (بدون تغيير أي حاجة تانية في الداتا/السلايدر) */
  .product-card{
    width: 380px;
    text-align:center;
    background: transparent;
    border: none;
    border-radius: 0;
    box-shadow: none;
    padding: 0;
    transition: transform .25s ease;
    overflow: visible;
  }

  .product-card:hover{
    transform: scale(1.02);
  }

  /* ====== SLIDER ====== */
  .slider {
    width: 100%;
    height: 420px;
    position: relative;
    overflow: hidden;
    border-radius: 15px;
    margin: 0 auto 12px;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .slider img {
    width: 350px;              /* ✅ Desktop image size */
    height: 420px;             /* ✅ Desktop image size */
    object-fit: cover;
    border-radius: 15px;
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    opacity: 0;
    transition: opacity 0.4s ease-in-out;

    /* ✅ أفضل عرض ممكن للصورة */
    image-rendering: auto;
    backface-visibility: hidden;
    transform-style: preserve-3d;
  }

  .slider img.active { opacity: 1; }

  .slider .nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: transparent;
    color: var(--burgundy);
    border: none;
    font-size: 34px;
    cursor: pointer;
    right: 10px;
    z-index: 2;
  }

  h2 {
    margin: 0 0 8px 0;
    color: var(--burgundy);
    font-size: 20px;
    font-family: 'Didot', serif !important;
  }

  p.description {
    opacity: 0;
    transform: translateX(30px);
    transition: opacity 1s ease, transform 1s ease;
    max-height: 100px;
    overflow: hidden;
    margin: 0 auto;
    max-width: 350px;
  }

  .product-card:hover p.description {
    opacity: 1;
    transform: translateX(0);
  }

  .price {
    margin-top: 8px;
    font-size: 14px;
    font-weight: bold;
    color: var(--burgundy);
  }

  .btn {
    background-color: var(--burgundy);
    border: none;
    padding: 10px 20px;
    border-radius: 10px;
    color: var(--beige);
    cursor: pointer;
    font-size: 14px;
    width: 350px; /* يظبط مع مقاس الصورة */
    margin: 12px auto 0;
    display: block;
    font-weight: 700;
  }

  .btn:hover { opacity: .92; }

  .back-home {
    display: block;
    text-align: center;
    margin: 40px 0;
    color: var(--burgundy);
    text-decoration: none;
    font-size: 20px;
    font-weight: 600;
  }

  /* ✅ الموبايل: نفس المقاس على كل التليفونات (ثابت) + في النص */
  @media (max-width: 768px){
    .products{
      padding: 26px 14px;
      gap: 22px;
    }

    .product-card{
      width: 100%;
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    .slider{
      height: 360px;
      width: 100%;
      max-width: 300px;
    }

    .slider img{
      width: 300px;     /* ✅ ثابت لكل الموبايلات */
      height: 360px;    /* ✅ ثابت لكل الموبايلات */
      object-fit: cover;
      left: 50%;
      transform: translateX(-50%);
    }

    .btn{
      width: 300px;
    }
  }
</style>
</head>

<body>

<header>
  <span id="headerTitle">Outdoor Flooring</span>
  <select id="langSelect">
    <option value="en">English</option>
    <option value="ar">العربية</option>
  </select>
</header>

<div class="products" id="productContainer"></div>

<a href="./index.html" class="back-home" id="backHome">← Back to Home</a>

<script>
const products = [
  {img:["https://i.postimg.cc/3w3xyp8J/Transformative-Appeal-of-Artificial-Grass-22-Artificial-Grass-Balcony-Designs-for-Urban-Greenery.jpg","https://i.postimg.cc/3RJNqGz0/download-(48).jpg"], price:650, name:{en:"Artificial Grass", ar:"عشب صناعي"}, desc:{en:"High-quality artificial grass perfect for balconies and outdoor areas.", ar:"عشب صناعي عالي الجودة مثالي للشرفات والمساحات الخارجية."}},
  {img:["https://i.postimg.cc/Hs9LchCf/ss.jpg","https://i.postimg.cc/Gmz9NS79/nd-10-13-21v2-60x90.jpg"], price:2400, name:{en:"Outdoor Rug ", ar:"سجادة خارجية "}, desc:{en:"Stylish outdoor rug that enhances your relaxing space beautifully.", ar:"سجادة خارجية أنيقة تعزز مساحتك للاسترخاء بشكل رائع."}},
  {img:["https://i.postimg.cc/JnsfmG1M/8585b557-6c5e-4356-a43c-307785d8d904.png","https://i.postimg.cc/2yrvJsZC/by.png"], price:2300, name:{en:"Outdoor Rug ", ar:"سجادة خارجية "}, desc:{en:"Soft texture design made to elevate outdoor comfort.", ar:"تصميم بنسيج ناعم لزيادة راحة المساحات الخارجية."}},
  {img:["https://i.postimg.cc/nrkYPG68/a3bcc819-611c-470d-bd90-a0d709e3139f.png","https://i.postimg.cc/Y0Hf74Ty/d.png"], price:2400, name:{en:"Outdoor Rug ", ar:"سجادة خارجية "}, desc:{en:"Modern outdoor piece that adds charm to your balcony or garden.", ar:"قطعة خارجية عصرية تضيف جمالًا لشرفتك أو حديقتك."}},
  {img:["https://i.postimg.cc/9fZ9kB9F/sysy.jpg","https://i.postimg.cc/fWt6T1pY/kk.png"], price:2400, name:{en:"Outdoor Rug ", ar:"سجادة خارجية "}, desc:{en:"Classic pattern rug that blends perfectly with outdoor furniture.", ar:"سجادة بنمط كلاسيكي تتناسب تمامًا مع الأثاث الخارجي."}},
  {img:["https://i.postimg.cc/8PVrFYjH/a02d32a6-d4ca-45b6-b2c9-bbf0ac5cd228.png","https://i.postimg.cc/DznCrMx5/dh.png"], price:2500, name:{en:"Outdoor Rug ", ar:"سجادة خارجية "}, desc:{en:"Elegant rug that creates a cozy and welcoming atmosphere.", ar:"سجادة أنيقة تخلق جوًا دافئًا ومرحبًا."}},
  {img:["https://i.postimg.cc/SxPS9XgR/eb424d8b-7c7c-4b57-b5b0-1e89703bef7a.png","https://i.postimg.cc/zDx678WB/j.png"], price:2400, name:{en:"Outdoor Rug ", ar:"سجادة خارجية"}, desc:{en:"Premium design perfect for stylish outdoor settings.", ar:"تصميم فاخر مثالي للمساحات الخارجية العصرية."}},
  {img:["https://i.postimg.cc/VvYrmM3x/9ba03e1a-85d6-443a-9934-b7bfe2e9154c.jpg","https://i.postimg.cc/RVGqC3jL/l.png"], price:2400, name:{en:"Outdoor Rug ", ar:"سجادة خارجية "}, desc:{en:"Luxury outdoor rug adding elegance and warmth to any space.", ar:"سجادة خارجية فاخرة تضيف أناقة ودفء لأي مكان."}}
];

/* ✅ UNIFIED CART KEY (same as Cart page) */
const CART_KEY = "nook_cart";

function safeParse(v){
  try { return JSON.parse(v); } catch(e){ return null; }
}
function getCart(){
  const data = safeParse(localStorage.getItem(CART_KEY));
  return Array.isArray(data) ? data : [];
}
function saveCart(cart){
  localStorage.setItem(CART_KEY, JSON.stringify(cart));
  localStorage.setItem("cartItems", JSON.stringify(cart)); // for checkout
}
function makeId(category, name, price, img){
  return `${category}__${name}__${price}__${img}`.toLowerCase()
    .replace(/\s+/g,"_")
    .replace(/[^\w\-]+/g,"");
}

function renderProducts(lang){
  const container = document.getElementById("productContainer");
  container.innerHTML = "";

  products.forEach((p,index)=>{
    const card = document.createElement("div");
    card.className = "product-card";

    const productName = p.name[lang];
    const id = makeId("outdoor_flooring", productName, p.price, p.img[0]);

    card.dataset.id = id;
    card.dataset.name = productName;
    card.dataset.price = p.price;
    card.dataset.img = p.img[0];

    let sliderImages = p.img.map((src,i)=>`<img src="${src}" class="${i===0?'active':''}">`).join("");

    const priceText =
      index === 0
      ? `${p.price} EGP / m²`
      : `${p.price} EGP`;

    card.innerHTML = `
      <div class="slider">
        ${sliderImages}
        <button class="nav-btn next">&#10095;</button>
      </div>
      <h2>${p.name[lang]}</h2>
      <p class="description">${p.desc[lang]}</p>
      <p class="price">${priceText}</p>
      <button class="btn add-to-cart">${lang==="ar"?"أضف إلى السلة":"Add to Cart"}</button>
    `;
    container.appendChild(card);
  });

  attachCartListeners(lang);
  attachSliders();
}

const langSelectEl = document.getElementById("langSelect");
langSelectEl.addEventListener("change", ()=>{
  const lang = langSelectEl.value;
  document.body.dir = lang==="ar"?"rtl":"ltr";
  document.getElementById("headerTitle").textContent = lang==="ar"?"الأرضيات الخارجية":"Outdoor Flooring";
  document.getElementById("backHome").textContent = lang==="ar"?"← العودة للرئيسية":"← Back to Home";
  renderProducts(lang);
});

function attachSliders(){
  document.querySelectorAll(".slider").forEach(slider=>{
    const images = slider.querySelectorAll("img");
    const nextBtn = slider.querySelector(".next");
    let index = 0;
    nextBtn.addEventListener("click", ()=>{
      index=(index+1)%images.length;
      images.forEach((img,i)=>img.classList.toggle("active",i===index));
    });
    setInterval(()=>{
      index=(index+1)%images.length;
      images.forEach((img,i)=>img.classList.toggle("active",i===index));
    },7000);
  });
}

function attachCartListeners(lang){
  document.querySelectorAll(".add-to-cart").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const card = btn.closest(".product-card");

      const product = {
        id: card.dataset.id,
        name: card.dataset.name,
        price: Number(card.dataset.price) || 0,
        img: card.dataset.img,
        qty: 1,
        category: "Outdoor Flooring",
        page: location.pathname,
        addedAt: new Date().toISOString()
      };

      let cart = getCart();
      const existing = cart.find(p => p.id === product.id);
      if(existing) existing.qty = (Number(existing.qty) || 1) + 1;
      else cart.push(product);

      saveCart(cart);

      btn.innerText = lang==="ar"?"تم الإضافة!":"Added!";
      btn.style.background="#fff";
      btn.style.color="#4b0e1f";

      setTimeout(()=>{
        btn.innerText = lang==="ar"?"أضف إلى السلة":"Add to Cart";
        btn.style.background="var(--burgundy)";
        btn.style.color="var(--beige)";
      },1200);
    });
  });
}

renderProducts("en");
</script>

</body>
</html>
